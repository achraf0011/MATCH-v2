<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ | Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ROOT VARIABLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --navy:       #050d1f;
  --navy2:      #0c1a35;
  --navy3:      #0f2147;
  --blue:       #1845d4;
  --blue2:      #2a5aff;
  --blue3:      #5b82ff;
  --gold:       #f5a623;
  --gold2:      #ffbe45;
  --teal:       #00d9b5;
  --red:        #e03e3e;
  --green:      #22c55e;
  --white:      #ffffff;
  --text:       rgba(255,255,255,0.88);
  --text2:      rgba(255,255,255,0.55);
  --text3:      rgba(255,255,255,0.25);
  --border:     rgba(255,255,255,0.08);
  --border2:    rgba(255,255,255,0.15);
  --card-bg:    rgba(255,255,255,0.04);
  --card-hover: rgba(42,90,255,0.12);
  --shadow:     0 4px 30px rgba(0,0,0,0.5);
  --shadow2:    0 8px 50px rgba(0,0,0,0.65);
  --r:          12px;
  --r2:         18px;
  --ease:       cubic-bezier(.4,0,.2,1);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET & BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

html { scroll-behavior: smooth; }

body {
  font-family: 'Tajawal', sans-serif;
  background: var(--navy);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
  line-height: 1.6;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMATED BACKGROUND
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.bg-canvas {
  position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden;
}
.bg-orb {
  position: absolute; border-radius: 50%; filter: blur(80px); animation: orbFloat 12s ease-in-out infinite;
}
.bg-orb-1 { width: 600px; height: 600px; background: rgba(24,69,212,.18); top: -200px; right: -200px; animation-delay: 0s; }
.bg-orb-2 { width: 400px; height: 400px; background: rgba(245,166,35,.1);  bottom: -150px; left: -100px; animation-delay: -5s; }
.bg-orb-3 { width: 300px; height: 300px; background: rgba(0,217,181,.08);  top: 50%; left: 30%; animation-delay: -9s; }

@keyframes orbFloat {
  0%,100% { transform: translate(0,0) scale(1); }
  33%  { transform: translate(30px,-20px) scale(1.05); }
  66%  { transform: translate(-20px,25px) scale(0.97); }
}

.bg-grid {
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background-image:
    linear-gradient(rgba(42,90,255,.035) 1px, transparent 1px),
    linear-gradient(90deg, rgba(42,90,255,.035) 1px, transparent 1px);
  background-size: 48px 48px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#navbar {
  position: fixed; top: 0; left: 0; right: 0; z-index: 900;
  height: 62px;
  background: rgba(5,13,31,.88);
  backdrop-filter: blur(20px) saturate(1.3);
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center;
  padding: 0 20px;
}
.nav-inner {
  display: flex; align-items: center; justify-content: space-between;
  width: 100%; max-width: 1100px; margin: 0 auto; gap: 16px;
}

/* Brand */
.brand {
  display: flex; align-items: center; gap: 11px;
  text-decoration: none; cursor: pointer; flex-shrink: 0;
}
.brand-logo {
  width: 38px; height: 38px; border-radius: 10px;
  background: linear-gradient(135deg, var(--blue2), var(--gold));
  display: flex; align-items: center; justify-content: center;
  font-size: 18px; box-shadow: 0 2px 14px rgba(42,90,255,.45);
  transition: transform .25s var(--ease);
}
.brand:hover .brand-logo { transform: rotate(-8deg) scale(1.08); }
.brand-name { font-family:'Cairo',sans-serif; font-weight:900; font-size:17px; }
.brand-name span { color: var(--gold); }

/* Nav links */
.nav-links { display:flex; align-items:center; gap:2px; list-style:none; }
.nav-link {
  background: none; border: none; cursor: pointer;
  font-family:'Tajawal',sans-serif; font-size:14.5px; font-weight:500;
  color: var(--text2); padding: 7px 14px; border-radius: 8px;
  transition: all .2s var(--ease); white-space: nowrap;
  display: flex; align-items: center; gap: 5px; text-decoration: none;
}
.nav-link:hover { color: var(--white); background: rgba(255,255,255,.08); }
.nav-link.active { color: var(--gold); background: rgba(245,166,35,.1); font-weight:700; }

/* Dropdown */
.nav-dd { position: relative; }
.dd-menu {
  display: none; position: absolute; top: calc(100% + 6px); right: 0;
  background: var(--navy2); border: 1px solid var(--border2);
  border-radius: var(--r); min-width: 195px; overflow: hidden;
  box-shadow: var(--shadow2); z-index: 901;
}
.nav-dd:hover .dd-menu { display: block; }
.dd-link {
  display: block; padding: 11px 18px; color: var(--text2); font-size:14px;
  text-decoration: none; transition: all .18s var(--ease); cursor: pointer;
}
.dd-link:hover { background: rgba(42,90,255,.15); color: var(--white); padding-right: 24px; }
.dd-link.active { color: var(--gold2); }

/* Admin area */
.nav-admin { display: flex; align-items: center; gap: 10px; margin-right: auto; }
.admin-badge {
  display: none; align-items: center; gap: 7px;
  background: rgba(34,197,94,.12); border: 1px solid rgba(34,197,94,.3);
  color: var(--green); border-radius: 20px; padding: 4px 12px; font-size:12px; font-weight:700;
}
.admin-badge.show { display: flex; }

#admin-login-btn {
  padding: 8px 18px; border-radius: 20px; border: none; cursor: pointer;
  font-family:'Tajawal',sans-serif; font-size:13.5px; font-weight:700;
  background: linear-gradient(135deg, var(--blue), var(--blue2));
  color: white; box-shadow: 0 2px 12px rgba(42,90,255,.4);
  transition: all .22s var(--ease); white-space: nowrap;
}
#admin-login-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 18px rgba(42,90,255,.55); }
#admin-login-btn.logout { background: linear-gradient(135deg, #b91c1c, var(--red)); }

/* Hamburger */
.hamburger {
  display: none; flex-direction: column; gap: 4px;
  background: none; border: none; cursor: pointer; padding: 6px;
}
.hamburger span { display:block; width:21px; height:2px; background:var(--text2); border-radius:2px; transition: all .25s var(--ease); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LAYOUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
main {
  position: relative; z-index: 1;
  padding-top: 62px; min-height: 100vh;
}
#page {
  max-width: 960px; margin: 0 auto;
  padding: 36px 20px 80px;
  animation: pageIn .32s var(--ease);
}
@keyframes pageIn {
  from { opacity:0; transform: translateY(18px); }
  to   { opacity:1; transform: none; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECTION HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sec-header {
  display: flex; align-items: center; gap: 14px;
  margin-bottom: 28px; padding-bottom: 18px;
  border-bottom: 1px solid var(--border);
}
.sec-icon {
  width: 46px; height: 46px; border-radius: 13px;
  background: linear-gradient(135deg, var(--blue2), var(--gold));
  display: flex; align-items: center; justify-content: center;
  font-size: 21px; box-shadow: 0 3px 16px rgba(42,90,255,.35); flex-shrink:0;
}
.sec-header h2 { font-family:'Cairo',sans-serif; font-size:24px; font-weight:900; }
.sec-count {
  margin-right: auto; background: rgba(42,90,255,.15); border: 1px solid rgba(42,90,255,.3);
  color: var(--blue3); border-radius: 20px; padding: 3px 12px; font-size:13px; font-weight:700;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ADMIN CONTROLS BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.admin-bar {
  display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
  background: linear-gradient(135deg, rgba(34,197,94,.07), rgba(34,197,94,.03));
  border: 1px solid rgba(34,197,94,.22); border-radius: var(--r);
  padding: 14px 18px; margin-bottom: 26px;
}
.admin-bar-label {
  font-size: 12px; color: var(--green); font-weight:700;
  background: rgba(34,197,94,.12); border-radius: 6px; padding: 3px 9px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BUTTONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.btn {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 10px 22px; border: none; border-radius: 10px; cursor: pointer;
  font-family:'Tajawal',sans-serif; font-size:14px; font-weight:700;
  transition: all .22s var(--ease); white-space: nowrap; text-decoration: none;
}
.btn-primary {
  background: linear-gradient(135deg, var(--blue), var(--blue2));
  color: white; box-shadow: 0 3px 14px rgba(42,90,255,.4);
}
.btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 22px rgba(42,90,255,.55); }

.btn-danger  { background: linear-gradient(135deg, #9b1c1c, var(--red)); color: white; }
.btn-danger:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(224,62,62,.4); }

.btn-success { background: linear-gradient(135deg, #15803d, var(--green)); color: white; }
.btn-success:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(34,197,94,.4); }

.btn-ghost   { background: rgba(255,255,255,.08); color: var(--text); border: 1px solid var(--border2); }
.btn-ghost:hover { background: rgba(255,255,255,.14); }

.btn-sm { padding: 7px 14px; font-size:13px; border-radius: 8px; }
.btn-icon { width:34px; height:34px; padding:0; border-radius:8px; justify-content:center; }

/* Download button â€” special */
.btn-download {
  background: linear-gradient(135deg, var(--blue), var(--blue2));
  color: white; padding: 9px 20px; border-radius: 10px;
  font-family:'Tajawal',sans-serif; font-size:13.5px; font-weight:700;
  text-decoration: none; display: inline-flex; align-items: center; gap: 7px;
  transition: all .22s var(--ease); box-shadow: 0 2px 12px rgba(42,90,255,.35);
  white-space: nowrap;
}
.btn-download:hover { transform: scale(1.04) translateY(-1px); box-shadow: 0 5px 18px rgba(42,90,255,.5); }
.btn-coming { color: var(--text3); font-size:13px; font-style:italic; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HOMEPAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.home-hero {
  text-align: center; padding: 52px 16px 44px;
}
.home-badge {
  display: inline-flex; align-items: center; gap: 8px;
  background: rgba(245,166,35,.1); border: 1px solid rgba(245,166,35,.3);
  color: var(--gold2); border-radius: 30px; padding: 6px 20px;
  font-size:13px; font-weight:700; margin-bottom: 22px;
}
.home-hero h1 {
  font-family:'Cairo',sans-serif;
  font-size: clamp(30px, 5vw, 50px); font-weight:900; line-height:1.2;
  margin-bottom: 14px;
  background: linear-gradient(135deg, var(--white) 40%, var(--gold));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.home-hero p { font-size:17px; color: var(--text2); max-width:500px; margin: 0 auto 42px; }

.home-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(210px,1fr)); gap:16px;
}
.home-card {
  background: var(--card-bg); border: 1px solid var(--border);
  border-radius: var(--r2); padding: 28px 20px; text-align:center;
  cursor: pointer; transition: all .28s var(--ease); position: relative; overflow: hidden;
}
.home-card::before {
  content:''; position:absolute; inset:0; opacity:0;
  background: radial-gradient(circle at 50% 0%, rgba(42,90,255,.15), transparent 70%);
  transition: opacity .3s var(--ease);
}
.home-card:hover { transform: translateY(-6px); border-color: rgba(42,90,255,.45); box-shadow: 0 12px 34px rgba(42,90,255,.18); }
.home-card:hover::before { opacity:1; }
.hc-icon { font-size:38px; margin-bottom:13px; display:block; }
.hc-title { font-family:'Cairo',sans-serif; font-weight:800; font-size:16px; margin-bottom:6px; }
.hc-count { font-size:13px; color: var(--text2); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VIDEO GRID
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.video-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(275px,1fr)); gap:20px;
}
.vid-card {
  background: var(--card-bg); border: 1px solid var(--border);
  border-radius: var(--r2); overflow: hidden; cursor: pointer;
  transition: all .28s var(--ease); position: relative;
  animation: cardIn .35s var(--ease) both;
}
@keyframes cardIn { from { opacity:0; transform: scale(.96); } to { opacity:1; transform: none; } }
.vid-card:hover { transform: translateY(-6px); border-color: rgba(42,90,255,.45); box-shadow: 0 14px 36px rgba(42,90,255,.22); }

.vid-thumb {
  position: relative; padding-top: 56.25%; overflow: hidden;
  background: linear-gradient(135deg, var(--navy2), var(--navy3));
}
.vid-thumb img {
  position: absolute; inset: 0; width:100%; height:100%; object-fit:cover;
  transition: transform .4s var(--ease);
}
.vid-card:hover .vid-thumb img { transform: scale(1.07); }
.vid-play {
  position: absolute; top:50%; left:50%; transform: translate(-50%,-50%);
  width: 52px; height: 52px; border-radius: 50%;
  background: rgba(255,255,255,.93); display:flex; align-items:center; justify-content:center;
  transition: all .25s var(--ease); box-shadow: 0 4px 18px rgba(0,0,0,.4);
}
.vid-play::after {
  content:''; width:0; height:0;
  border-left: 18px solid var(--blue2);
  border-top: 11px solid transparent; border-bottom: 11px solid transparent;
  margin-right: -4px;
}
.vid-card:hover .vid-play { transform: translate(-50%,-50%) scale(1.12); background: white; }

.vid-info { padding: 15px 16px; }
.vid-title { font-family:'Cairo',sans-serif; font-weight:700; font-size:14.5px; color:var(--white); margin-bottom:5px; line-height:1.4; }
.vid-desc  { font-size:12.5px; color: var(--text2); line-height:1.5; }

/* Admin delete overlay on video card */
.vid-del {
  position: absolute; top:9px; left:9px; z-index:5;
  width:30px; height:30px; border-radius:7px;
  background: rgba(224,62,62,.82); border:none; color:white;
  cursor:pointer; font-size:13px; display:none; align-items:center; justify-content:center;
  transition: all .2s var(--ease); backdrop-filter: blur(4px);
}
.vid-del:hover { background: var(--red); transform:scale(1.1); }
.admin-active .vid-del { display:flex; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PDF / EXERCISE / TEST LIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.doc-list { display:flex; flex-direction:column; gap:13px; }
.doc-item {
  display: flex; align-items: center; gap:16px;
  background: var(--card-bg); border: 1px solid var(--border);
  border-radius: var(--r); padding: 18px 20px;
  transition: all .25s var(--ease);
  animation: cardIn .3s var(--ease) both;
}
.doc-item:hover { border-color: rgba(42,90,255,.4); background: var(--card-hover); transform: translateX(-4px); }

.doc-icon {
  width: 48px; height: 48px; border-radius: 12px; flex-shrink:0;
  display:flex; align-items:center; justify-content:center; font-size:22px;
}
.doc-icon.pdf   { background: linear-gradient(135deg, #b91c1c, #e03e3e); }
.doc-icon.ex    { background: linear-gradient(135deg, #6d28d9, #8b5cf6); }
.doc-icon.test  { background: linear-gradient(135deg, var(--gold2), var(--gold)); }

.doc-body { flex:1; min-width:0; }
.doc-title { font-family:'Cairo',sans-serif; font-weight:700; font-size:15.5px; margin-bottom:4px; }
.doc-desc  { font-size:13px; color: var(--text2); }

.doc-actions { display:flex; gap:8px; align-items:center; }
.doc-del {
  width:34px; height:34px; border-radius:8px; border:1px solid rgba(224,62,62,.3);
  background: rgba(224,62,62,.1); color: var(--red); cursor:pointer; font-size:15px;
  display:none; align-items:center; justify-content:center; transition:all .2s var(--ease);
}
.doc-del:hover { background: rgba(224,62,62,.25); border-color:rgba(224,62,62,.5); }
.admin-active .doc-del { display:flex; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EMPTY STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.empty {
  text-align:center; padding: 64px 20px;
  color: var(--text3); display:flex; flex-direction:column; align-items:center; gap:14px;
}
.empty-icon { font-size: 54px; opacity:.45; }
.empty p { font-size:15px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODALS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.overlay {
  display:none; position:fixed; inset:0; z-index:1000;
  background: rgba(0,0,0,.72); backdrop-filter:blur(8px);
  justify-content:center; align-items:center; padding:20px;
}
.overlay.open { display:flex; }

.modal {
  background: var(--navy2); border: 1px solid var(--border2);
  border-radius: var(--r2); padding: 36px 32px;
  max-width: 480px; width:100%; max-height:92vh; overflow-y:auto;
  box-shadow: var(--shadow2); animation: modalIn .28s var(--ease);
}
@keyframes modalIn { from { transform:translateY(36px) scale(.97); opacity:0; } to { transform:none; opacity:1; } }

.modal-head {
  text-align:center; margin-bottom:28px;
}
.modal-head .micon { font-size:36px; display:block; margin-bottom:10px; }
.modal-head h3 { font-family:'Cairo',sans-serif; font-size:21px; font-weight:800; }
.modal-head p  { font-size:13.5px; color:var(--text2); margin-top:5px; }

.form-field { margin-bottom:18px; }
.form-field label { display:block; font-size:13.5px; font-weight:600; color:rgba(255,255,255,.75); margin-bottom:8px; }
.form-field input, .form-field textarea {
  width:100%; padding:12px 16px;
  background: rgba(255,255,255,.06); border: 1.5px solid var(--border2);
  border-radius: 10px; font-size:14.5px; font-family:'Tajawal',sans-serif;
  color: var(--white); transition: border-color .2s var(--ease);
}
.form-field input[type="file"] { padding:10px; }
.form-field input:focus, .form-field textarea:focus {
  outline:none; border-color: var(--blue2); background: rgba(42,90,255,.08);
}
.form-field input::placeholder, .form-field textarea::placeholder { color: var(--text3); }
.form-field textarea { resize:vertical; min-height:85px; }

.field-hint { font-size:12px; color: var(--text3); margin-top:5px; }

.modal-foot { display:flex; gap:12px; margin-top:24px; }
.modal-foot .btn { flex:1; justify-content:center; padding:13px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#toast {
  position: fixed; bottom:28px; left:50%;
  transform: translateX(-50%) translateY(14px);
  background: var(--navy2); border: 1px solid var(--border2);
  color: var(--white); padding: 12px 26px; border-radius: 30px;
  font-size:14px; font-weight:600; box-shadow: var(--shadow2);
  z-index: 2000; opacity:0; transition: all .3s var(--ease);
  pointer-events:none; white-space:nowrap; max-width:90vw;
}
#toast.on { opacity:1; transform: translateX(-50%) translateY(0); }
#toast.ok  { border-color: rgba(34,197,94,.4);  color: #4ade80; }
#toast.err { border-color: rgba(224,62,62,.4);   color: #f87171; }
#toast.inf { border-color: rgba(42,90,255,.4);   color: var(--blue3); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CHAT WIDGET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#chat-widget { position:fixed; bottom:24px; left:24px; z-index:800; }

#chat-fab {
  width:56px; height:56px; border-radius:50%; border:none; cursor:pointer;
  background: linear-gradient(135deg, var(--blue), var(--blue2));
  color:white; font-size:24px;
  display:flex; align-items:center; justify-content:center;
  box-shadow: 0 4px 22px rgba(42,90,255,.55);
  transition: all .25s var(--ease); position:relative;
}
#chat-fab:hover { transform:scale(1.1); box-shadow: 0 6px 28px rgba(42,90,255,.7); }
#chat-fab.open  { background: linear-gradient(135deg, #374151, #4b5563); }

.unread-badge {
  position:absolute; top:-3px; right:-3px;
  width:17px; height:17px; border-radius:50%;
  background:var(--red); font-size:10px; font-weight:800;
  display:none; align-items:center; justify-content:center;
  border: 2px solid var(--navy); color:white;
}
.unread-badge.show { display:flex; }

#chat-box {
  display:none; position:absolute; bottom:68px; left:0;
  width: 780px; height: 510px;
  background: var(--navy2); border: 1px solid var(--border2);
  border-radius: 20px; box-shadow: var(--shadow2); overflow:hidden;
}
#chat-box.open { display:flex; animation: modalIn .28s var(--ease); }

.chat-layout { display:flex; width:100%; height:100%; }

/* Sidebar */
.chat-sidebar {
  width: 250px; flex-shrink:0;
  border-left: 1px solid var(--border);
  background: rgba(0,0,0,.22);
  display:flex; flex-direction:column;
}
.csb-head {
  padding:16px 16px 12px;
  background: linear-gradient(135deg, var(--navy), var(--navy2));
  border-bottom: 1px solid var(--border);
  font-family:'Cairo',sans-serif; font-weight:800; font-size:14px;
  display:flex; align-items:center; gap:8px;
}
.csb-search { padding:10px 12px; border-bottom: 1px solid var(--border); }
.csb-search input {
  width:100%; background:rgba(255,255,255,.07); border:1.5px solid var(--border);
  border-radius:18px; padding:8px 13px; color:white; font-family:'Tajawal',sans-serif; font-size:13px;
  transition: border-color .2s var(--ease);
}
.csb-search input:focus { outline:none; border-color: var(--blue2); }
.csb-search input::placeholder { color: var(--text3); }

.friends-list { flex:1; overflow-y:auto; padding:6px 0; }
.friend {
  display:flex; align-items:center; gap:10px; padding:10px 14px;
  cursor:pointer; transition:all .18s var(--ease); border-right:3px solid transparent;
}
.friend:hover  { background: rgba(255,255,255,.05); }
.friend.active { background: rgba(42,90,255,.15); border-right-color: var(--blue2); }

.f-avatar {
  width:36px; height:36px; border-radius:50%; flex-shrink:0;
  display:flex; align-items:center; justify-content:center;
  font-family:'Cairo',sans-serif; font-weight:800; font-size:14px;
  background: linear-gradient(135deg, var(--blue2), var(--gold));
}
.f-name   { font-size:13px; font-weight:600; margin-bottom:2px; }
.f-status { font-size:11px; color:var(--teal); display:flex; align-items:center; gap:4px; }
.f-status::before { content:'â—'; font-size:7px; }

/* Chat main */
.chat-main { flex:1; display:flex; flex-direction:column; overflow:hidden; }

.chat-header {
  padding:14px 18px;
  background: linear-gradient(135deg, var(--navy), var(--navy2));
  border-bottom: 1px solid var(--border);
  display:flex; justify-content:space-between; align-items:center; flex-shrink:0;
}
.ch-info { display:flex; align-items:center; gap:10px; }
.ch-name { font-weight:700; font-size:14.5px; }
.ch-sub  { font-size:11px; color:var(--teal); }
.ch-close {
  width:28px; height:28px; border-radius:50%; border:none;
  background: rgba(255,255,255,.08); color:white; cursor:pointer; font-size:18px;
  display:flex; align-items:center; justify-content:center; transition:all .2s var(--ease);
}
.ch-close:hover { background: rgba(224,62,62,.3); }

.chat-no-sel {
  flex:1; display:flex; flex-direction:column;
  align-items:center; justify-content:center; gap:14px; color:var(--text3);
}
.chat-no-sel .big { font-size:50px; opacity:.35; }
.chat-no-sel p { font-size:15px; }

#chat-msgs {
  flex:1; padding:16px 18px; overflow-y:auto;
  display:flex; flex-direction:column; gap:10px;
  background: rgba(0,0,0,.12);
}

/* Message bubbles */
.msg-row { display:flex; }
.msg-row.me  { justify-content:flex-start; }
.msg-row.you { justify-content:flex-end; }

.bubble {
  max-width:70%; padding:10px 14px; border-radius:16px;
  font-size:13.5px; line-height:1.55; word-break:break-word;
  box-shadow: 0 2px 8px rgba(0,0,0,.3);
}
.msg-row.me  .bubble { background: linear-gradient(135deg, var(--blue), var(--blue2)); color:white; border-bottom-right-radius:4px; }
.msg-row.you .bubble { background: rgba(255,255,255,.1); color:white; border-bottom-left-radius:4px; }

.msg-time { font-size:10px; color:rgba(255,255,255,.4); margin-top:4px; }

.msg-img { max-width:220px; border-radius:10px; cursor:pointer; margin-top:6px; display:block; transition: opacity .2s; }
.msg-img:hover { opacity:.85; }

.audio-pill {
  display:flex; align-items:center; gap:9px;
  background:rgba(0,0,0,.25); padding:9px 13px; border-radius:10px; margin-top:5px;
}
.audio-btn {
  width:30px; height:30px; border-radius:50%;
  background:rgba(255,255,255,.22); border:none; color:white; cursor:pointer;
  font-size:12px; display:flex; align-items:center; justify-content:center;
  transition:all .2s var(--ease);
}
.audio-btn:hover { background:rgba(255,255,255,.38); transform:scale(1.08); }
.audio-label { font-size:12.5px; color:rgba(255,255,255,.75); }

/* Input */
.chat-input-area {
  padding:12px 16px;
  background: var(--navy2); border-top:1px solid var(--border); flex-shrink:0;
}
.input-row { display:flex; align-items:flex-end; gap:8px; }
.media-btns { display:flex; gap:6px; }
.media-btn {
  width:35px; height:35px; border-radius:50%; border:1.5px solid var(--border2);
  background:rgba(255,255,255,.06); cursor:pointer; font-size:15px;
  display:flex; align-items:center; justify-content:center; transition:all .2s var(--ease);
}
.media-btn:hover { background:rgba(255,255,255,.14); border-color:var(--blue3); transform:scale(1.06); }
#msg-input {
  flex:1; background:rgba(255,255,255,.07); border:1.5px solid var(--border2);
  border-radius:18px; padding:9px 15px; color:white;
  font-family:'Tajawal',sans-serif; font-size:13.5px;
  resize:none; min-height:36px; max-height:90px; transition:border-color .2s var(--ease);
}
#msg-input:focus { outline:none; border-color:var(--blue2); }
#msg-input::placeholder { color:var(--text3); }
#send-btn {
  width:36px; height:36px; border-radius:50%; border:none; cursor:pointer;
  background: linear-gradient(135deg, var(--blue), var(--blue2));
  color:white; font-size:16px;
  display:flex; align-items:center; justify-content:center;
  transition:all .22s var(--ease); flex-shrink:0;
}
#send-btn:hover { transform:scale(1.12); box-shadow:0 3px 14px rgba(42,90,255,.5); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLLBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
::-webkit-scrollbar { width:5px; height:5px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:rgba(255,255,255,.14); border-radius:10px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width:820px) {
  #chat-box { width: calc(100vw - 32px); height: calc(100vh - 130px); bottom:70px; }
  .chat-sidebar { width:200px; }
}
@media (max-width:640px) {
  .hamburger { display:flex; }
  .nav-links {
    display:none; flex-direction:column; gap:0; list-style:none;
    position:fixed; top:62px; right:0; bottom:0; width:270px;
    background:var(--navy2); border-left:1px solid var(--border2);
    padding:16px 0; overflow-y:auto; z-index:890;
  }
  .nav-links.open { display:flex; animation: sideIn .25s var(--ease); }
  @keyframes sideIn { from { transform:translateX(100%); } to { transform:none; } }
  .nav-link { width:100%; padding:12px 22px; border-radius:0; }
  .dd-menu { position:static; box-shadow:none; border:none; background:rgba(0,0,0,.2); border-radius:0; }
  .dd-link { padding-right:36px; }
  .chat-sidebar { display:none; }
  .chat-sidebar.sb-open { display:flex; position:absolute; inset:0; z-index:10; width:100%; }
  #chat-box { left:0; right:0; margin:0 16px; width:auto; }
}
@media (max-width:420px) {
  .home-grid { grid-template-columns:1fr 1fr; }
  .video-grid { grid-template-columns:1fr; }
}
</style>
</head>

<body>
<!-- Backgrounds -->
<div class="bg-canvas">
  <div class="bg-orb bg-orb-1"></div>
  <div class="bg-orb bg-orb-2"></div>
  <div class="bg-orb bg-orb-3"></div>
</div>
<div class="bg-grid"></div>

<!-- Toast -->
<div id="toast"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAVBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav id="navbar">
  <div class="nav-inner">

    <!-- Admin area (left side in RTL = right visually) -->
    <div class="nav-admin">
      <div class="admin-badge" id="admin-badge">âœ… Ù…Ø³Ø¤ÙˆÙ„</div>
      <button id="admin-login-btn" onclick="handleAdminBtn()">ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</button>
    </div>

    <!-- Brand -->
    <div class="brand" onclick="nav('home')">
      <div class="brand-logo">ğŸ“š</div>
      <div class="brand-name">Ù…Ø¯Ø§Ø±Ùƒ <span>Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</span></div>
    </div>

    <!-- Nav links -->
    <ul class="nav-links" id="nav-links">
      <li><button class="nav-link active" id="nl-home" onclick="nav('home');closeMenu()">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></li>
      <li class="nav-dd">
        <button class="nav-link" id="nl-lessons">ğŸ“– Ø§Ù„Ø¯Ø±ÙˆØ³ â–¾</button>
        <div class="dd-menu">
          <a class="dd-link" id="nl-video" onclick="nav('video');closeMenu()">ğŸ¬ Ø´Ø±Ø­ Ø¨Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</a>
          <a class="dd-link" id="nl-pdf"   onclick="nav('pdf');closeMenu()">ğŸ“„ ØªØ­Ù…ÙŠÙ„ PDF</a>
        </div>
      </li>
      <li><button class="nav-link" id="nl-ex"    onclick="nav('exercises');closeMenu()">ğŸ“ Ø³Ù„Ø§Ø³Ù„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</button></li>
      <li><button class="nav-link" id="nl-tests" onclick="nav('tests');closeMenu()">ğŸ“‹ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</button></li>
    </ul>

    <button class="hamburger" id="hamburger" onclick="toggleMenu()" aria-label="Ù‚Ø§Ø¦Ù…Ø©">
      <span></span><span></span><span></span>
    </button>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main>
  <div id="page"></div>
</main>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODALS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- Admin Login -->
<div class="overlay" id="m-login">
  <div class="modal" style="max-width:420px">
    <div class="modal-head">
      <span class="micon">ğŸ”</span>
      <h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h3>
      <p>Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
    </div>
    <div class="form-field">
      <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
      <input type="email" id="l-email" placeholder="admin@example.com" autocomplete="email"/>
    </div>
    <div class="form-field">
      <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
      <input type="password" id="l-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password"
             onkeydown="if(event.key==='Enter')doLogin()"/>
    </div>
    <div class="modal-foot">
      <button class="btn btn-primary" onclick="doLogin()">ğŸš€ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
      <button class="btn btn-ghost"   onclick="closeM('m-login')">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<!-- Add Video -->
<div class="overlay" id="m-video">
  <div class="modal">
    <div class="modal-head">
      <span class="micon">ğŸ¬</span>
      <h3>Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯</h3>
    </div>
    <div class="form-field">
      <label>Ø±Ø§Ø¨Ø· YouTube <span style="color:var(--red)">*</span></label>
      <input type="url" id="f-vurl" placeholder="https://www.youtube.com/watch?v=..."/>
      <p class="field-hint">ÙŠØ¯Ø¹Ù… Ø±ÙˆØ§Ø¨Ø· youtube.com Ùˆ youtu.be</p>
    </div>
    <div class="form-field">
      <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ <span style="color:var(--red)">*</span></label>
      <input type="text" id="f-vtitle" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ"/>
    </div>
    <div class="form-field">
      <label>ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</label>
      <textarea id="f-vdesc" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ø¯Ø±Ø³..."></textarea>
    </div>
    <div class="modal-foot">
      <button class="btn btn-primary" onclick="submitVideo()">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
      <button class="btn btn-ghost"   onclick="closeM('m-video')">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<!-- Upload PDF -->
<div class="overlay" id="m-pdf">
  <div class="modal">
    <div class="modal-head">
      <span class="micon">ğŸ“„</span>
      <h3>Ø±ÙØ¹ Ù…Ù„Ù PDF</h3>
    </div>
    <div class="form-field">
      <label>Ù…Ù„Ù PDF <span style="color:var(--red)">*</span></label>
      <input type="file" id="f-pfile" accept=".pdf,application/pdf"/>
      <p class="field-hint">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø­Ø¬Ù…: 20 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</p>
    </div>
    <div class="form-field">
      <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù <span style="color:var(--red)">*</span></label>
      <input type="text" id="f-ptitle" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù"/>
    </div>
    <div class="form-field">
      <label>ÙˆØµÙ Ø§Ù„Ù…Ù„Ù</label>
      <textarea id="f-pdesc" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ±..."></textarea>
    </div>
    <div class="modal-foot">
      <button class="btn btn-primary" onclick="submitPDF()">ğŸ“¤ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù</button>
      <button class="btn btn-ghost"   onclick="closeM('m-pdf')">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<!-- Upload Exercise -->
<div class="overlay" id="m-ex">
  <div class="modal">
    <div class="modal-head">
      <span class="micon">ğŸ“</span>
      <h3>Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø³Ù„Ø© ØªÙ…Ø§Ø±ÙŠÙ†</h3>
    </div>
    <div class="form-field">
      <label>Ù…Ù„Ù PDF (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input type="file" id="f-exfile" accept=".pdf,application/pdf"/>
    </div>
    <div class="form-field">
      <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† <span style="color:var(--red)">*</span></label>
      <input type="text" id="f-extitle" placeholder="Ù…Ø«Ø§Ù„: Ø³Ù„Ø³Ù„Ø© ØªÙ…Ø§Ø±ÙŠÙ† - Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒØ³Ø±ÙŠØ©"/>
    </div>
    <div class="form-field">
      <label>Ø§Ù„ÙˆØµÙ</label>
      <textarea id="f-exdesc" placeholder="ÙˆØµÙ Ø§Ù„Ø³Ù„Ø³Ù„Ø©..."></textarea>
    </div>
    <div class="modal-foot">
      <button class="btn btn-primary" onclick="submitExercise()">â• Ø¥Ø¶Ø§ÙØ©</button>
      <button class="btn btn-ghost"   onclick="closeM('m-ex')">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<!-- Upload Test -->
<div class="overlay" id="m-test">
  <div class="modal">
    <div class="modal-head">
      <span class="micon">ğŸ“‹</span>
      <h3>Ø¥Ø¶Ø§ÙØ© Ø§Ù…ØªØ­Ø§Ù† ØªØ¬Ø±ÙŠØ¨ÙŠ</h3>
    </div>
    <div class="form-field">
      <label>Ù…Ù„Ù PDF (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input type="file" id="f-testfile" accept=".pdf,application/pdf"/>
    </div>
    <div class="form-field">
      <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† <span style="color:var(--red)">*</span></label>
      <input type="text" id="f-testtitle" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„ - Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª"/>
    </div>
    <div class="form-field">
      <label>Ø§Ù„ÙˆØµÙ</label>
      <textarea id="f-testdesc" placeholder="ÙˆØµÙ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†..."></textarea>
    </div>
    <div class="modal-foot">
      <button class="btn btn-primary" onclick="submitTest()">â• Ø¥Ø¶Ø§ÙØ©</button>
      <button class="btn btn-ghost"   onclick="closeM('m-test')">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHAT WIDGET â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="chat-widget">
  <button id="chat-fab" onclick="toggleChat()" aria-label="Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª">
    ğŸ’¬
    <span class="unread-badge" id="unread-badge"></span>
  </button>

  <div id="chat-box">
    <div class="chat-layout">
      <!-- Sidebar -->
      <div class="chat-sidebar" id="chat-sidebar">
        <div class="csb-head">ğŸ‘¥ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡</div>
        <div class="csb-search">
          <input type="text" placeholder="Ø¨Ø­Ø«..." id="f-search" oninput="filterFriends(this.value)"/>
        </div>
        <div class="friends-list" id="friends-list"></div>
      </div>

      <!-- Chat main -->
      <div class="chat-main" id="chat-main">
        <div class="chat-no-sel">
          <span class="big">ğŸ’¬</span>
          <p>Ø§Ø®ØªØ± ØµØ¯ÙŠÙ‚Ù‹Ø§ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Hidden file inputs -->
<input type="file" id="img-pick" accept="image/*" style="display:none">
<input type="file" id="aud-pick" accept="audio/*" style="display:none">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• JAVASCRIPT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
'use strict';

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CREDENTIALS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const CREDS = { email:'anynhfm75@gmail.com', pass:'achraf1258' };

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let isAdmin    = false;
let curSection = 'home';
let chatOpen   = false;
let selFriend  = null;
let menuOpen   = false;

const friends = [
  { id:1, name:'Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯',     av:'Ù…' },
  { id:2, name:'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡', av:'Ù' },
  { id:3, name:'Ø¹Ù…Ø± Ø®Ø§Ù„Ø¯',      av:'Ø¹' },
  { id:4, name:'Ø³Ø§Ø±Ø© Ø¹Ù„ÙŠ',      av:'Ø³' },
];

let convos = {};
friends.forEach(f => { convos[f.id] = []; });

/* Pre-seeded data */
let videos = [
  { id:'KOKfZKowOaI', title:'Droites dans le plan : parallÃ©lisme et perpendicularitÃ©', desc:'Ø´Ø±Ø­ Ø¯Ø±Ø³ Ø§Ù„Ø®Ø·ÙˆØ· ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰: Ø§Ù„ØªÙˆØ§Ø²ÙŠ ÙˆØ§Ù„Ø¹Ù…ÙˆØ¯ÙŠØ©' },
  { id:'34KkBOpkx2Y', title:'Droites dans le plan : suite',                             desc:'ØªÙƒÙ…Ù„Ø© Ø´Ø±Ø­ Ø¯Ø±Ø³ Ø§Ù„Ø®Ø·ÙˆØ· ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰' },
];
let pdfs = [
  { title:'Ø§Ù„Ø®Ø·ÙˆØ· ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰: Ø§Ù„ØªÙˆØ§Ø²ÙŠ ÙˆØ§Ù„Ø¹Ù…ÙˆØ¯ÙŠØ©', desc:'PDF - Droites dans le plan',       url:null },
  { title:'Ø§Ù„Ù…Ø³ØªÙ‚ÙŠÙ…Ø§Øª Ø§Ù„Ù‡Ø§Ù…Ø© ÙÙŠ Ù…Ø«Ù„Ø«',             desc:'PDF - Droites remarquables du triangle', url:null },
];
let exercises = [
  { title:'Ø³Ù„Ø³Ù„Ø© ØªÙ…Ø§Ø±ÙŠÙ† 1: Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒØ³Ø±ÙŠØ©', desc:'ØªÙ…Ø§Ø±ÙŠÙ† Ù…ØªÙ†ÙˆØ¹Ø© Ø­ÙˆÙ„ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒØ³Ø±ÙŠØ© - Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ', url:null },
];
let tests = [
  { title:'Ø§Ù…ØªØ­Ø§Ù† ØªØ¬Ø±ÙŠØ¨ÙŠ ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª', desc:'Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„ - Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ', url:null },
];

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let _toastT;
function toast(msg, type='ok') {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.className = 'on ' + type;
  clearTimeout(_toastT);
  _toastT = setTimeout(() => { el.className = ''; }, 3400);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MODALS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function openM(id)  { document.getElementById(id).classList.add('open'); }
function closeM(id) { document.getElementById(id).classList.remove('open'); }

document.querySelectorAll('.overlay').forEach(o => {
  o.addEventListener('click', e => { if(e.target===o) o.classList.remove('open'); });
});
document.addEventListener('keydown', e => {
  if(e.key==='Escape') document.querySelectorAll('.overlay.open').forEach(o=>o.classList.remove('open'));
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ADMIN AUTH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function handleAdminBtn() {
  if(isAdmin) doLogout(); else openM('m-login');
}

function doLogin() {
  const email = document.getElementById('l-email').value.trim();
  const pass  = document.getElementById('l-pass').value;
  if(email === CREDS.email && pass === CREDS.pass) {
    isAdmin = true;
    document.getElementById('l-email').value = '';
    document.getElementById('l-pass').value  = '';
    closeM('m-login');
    updateAdminUI();
    toast('âœ… Ù…Ø±Ø­Ø¨Ù‹Ø§! ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
    render();
  } else {
    toast('âŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'err');
    document.getElementById('l-pass').value = '';
    document.getElementById('l-pass').focus();
  }
}

function doLogout() {
  if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…ØŸ')) return;
  isAdmin = false;
  updateAdminUI();
  toast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'inf');
  render();
}

function updateAdminUI() {
  const btn   = document.getElementById('admin-login-btn');
  const badge = document.getElementById('admin-badge');
  if(isAdmin) {
    btn.textContent = 'ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬';
    btn.classList.add('logout');
    badge.classList.add('show');
    document.body.classList.add('admin-active');
  } else {
    btn.textContent = 'ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„';
    btn.classList.remove('logout');
    badge.classList.remove('show');
    document.body.classList.remove('admin-active');
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const NAV_MAP = {
  home:'nl-home', video:'nl-video', pdf:'nl-pdf',
  exercises:'nl-ex', tests:'nl-tests'
};

function nav(section) {
  curSection = section;
  Object.entries(NAV_MAP).forEach(([s, id]) => {
    const el = document.getElementById(id);
    if(el) el.classList.toggle('active', s===section);
  });
  render();
  window.scrollTo({ top:0, behavior:'smooth' });
}

function render() {
  const p = document.getElementById('page');
  p.style.animation = 'none'; p.offsetHeight; p.style.animation = '';
  if(curSection==='home')      renderHome();
  else if(curSection==='video')     renderVideos();
  else if(curSection==='pdf')       renderPDFs();
  else if(curSection==='exercises') renderExercises();
  else if(curSection==='tests')     renderTests();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HOME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderHome() {
  document.getElementById('page').innerHTML = `
    <div class="home-hero">
      <div class="home-badge">ğŸ“ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ Â· Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</div>
      <h1>Ù…Ù†ØµØªÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h1>
      <p>ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù…Ù† Ø¯Ø±ÙˆØ³ØŒ ØªÙ…Ø§Ø±ÙŠÙ†ØŒ ÙˆØ§Ù…ØªØ­Ø§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯</p>
      <div class="home-grid">
        <div class="home-card" onclick="nav('video')">
          <span class="hc-icon">ğŸ¬</span>
          <div class="hc-title">Ø´Ø±Ø­ Ø¨Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</div>
          <div class="hc-count">${videos.length} ÙÙŠØ¯ÙŠÙˆ</div>
        </div>
        <div class="home-card" onclick="nav('pdf')">
          <span class="hc-icon">ğŸ“„</span>
          <div class="hc-title">ØªØ­Ù…ÙŠÙ„ PDF</div>
          <div class="hc-count">${pdfs.length} Ù…Ù„Ù</div>
        </div>
        <div class="home-card" onclick="nav('exercises')">
          <span class="hc-icon">ğŸ“</span>
          <div class="hc-title">Ø³Ù„Ø§Ø³Ù„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</div>
          <div class="hc-count">${exercises.length} Ø³Ù„Ø³Ù„Ø©</div>
        </div>
        <div class="home-card" onclick="nav('tests')">
          <span class="hc-icon">ğŸ“‹</span>
          <div class="hc-title">Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©</div>
          <div class="hc-count">${tests.length} Ø§Ù…ØªØ­Ø§Ù†</div>
        </div>
      </div>
    </div>`;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VIDEOS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderVideos() {
  const adminBar = isAdmin ? `
    <div class="admin-bar">
      <span class="admin-bar-label">ğŸ›¡ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</span>
      <button class="btn btn-primary btn-sm" onclick="openM('m-video')">â• Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯</button>
      <button class="btn btn-danger  btn-sm" onclick="doLogout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>` : '';

  const cards = videos.length
    ? videos.map((v,i) => `
        <div class="vid-card" onclick="openVideo('${v.id}')">
          <div class="vid-thumb">
            <img src="https://img.youtube.com/vi/${v.id}/hqdefault.jpg"
                 alt="${esc(v.title)}" loading="lazy"
                 onerror="this.src='';this.parentElement.style.background='linear-gradient(135deg,#1a2a5a,#0f1a35)'">
            <div class="vid-play"></div>
          </div>
          <button class="vid-del" onclick="event.stopPropagation();delVideo(${i})" title="Ø­Ø°Ù">ğŸ—‘</button>
          <div class="vid-info">
            <div class="vid-title">${esc(v.title)}</div>
            <div class="vid-desc">${esc(v.desc)}</div>
          </div>
        </div>`).join('')
    : `<div class="empty" style="grid-column:1/-1">
         <span class="empty-icon">ğŸ¬</span><p>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¨Ø¹Ø¯.<br>${isAdmin?'Ø£Ø¶Ù Ø£ÙˆÙ„ ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø²Ø± Ø£Ø¹Ù„Ø§Ù‡.':''}</p>
       </div>`;

  document.getElementById('page').innerHTML = `
    <div class="sec-header">
      <div class="sec-icon">ğŸ¬</div>
      <h2>Ø´Ø±Ø­ Ø¨Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</h2>
      <span class="sec-count">${videos.length}</span>
    </div>
    ${adminBar}
    <div class="video-grid">${cards}</div>`;
}

function openVideo(id) {
  window.open(`https://www.youtube.com/watch?v=${id}`, '_blank');
}

function submitVideo() {
  const url   = document.getElementById('f-vurl').value.trim();
  const title = document.getElementById('f-vtitle').value.trim();
  const desc  = document.getElementById('f-vdesc').value.trim();
  if(!url||!title)   { toast('âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'err'); return; }
  const id = extractYTID(url);
  if(!id) { toast('âŒ Ø±Ø§Ø¨Ø· YouTube ØºÙŠØ± ØµØ­ÙŠØ­. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'err'); return; }
  videos.unshift({ id, title, desc: desc||'Ø¯Ø±Ø³ ØªØ¹Ù„ÙŠÙ…ÙŠ' });
  ['f-vurl','f-vtitle','f-vdesc'].forEach(id => { document.getElementById(id).value=''; });
  closeM('m-video');
  toast('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­!');
  renderVideos();
}

function delVideo(i) {
  if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ØŸ')) return;
  videos.splice(i,1);
  toast('ØªÙ… Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ', 'inf');
  renderVideos();
}

function extractYTID(url) {
  const m = url.match(/(?:youtu\.be\/|youtube\.com\/(?:watch\?(?:.*&)?v=|embed\/|shorts\/))([A-Za-z0-9_-]{11})/);
  return m ? m[1] : null;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PDFs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderPDFs() {
  const adminBar = isAdmin ? `
    <div class="admin-bar">
      <span class="admin-bar-label">ğŸ›¡ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</span>
      <button class="btn btn-primary btn-sm" onclick="openM('m-pdf')">ğŸ“¤ Ø±ÙØ¹ Ù…Ù„Ù PDF</button>
      <button class="btn btn-danger  btn-sm" onclick="doLogout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>` : '';

  const items = pdfs.length
    ? pdfs.map((p,i) => `
        <div class="doc-item">
          <div class="doc-icon pdf">ğŸ“„</div>
          <div class="doc-body">
            <div class="doc-title">${esc(p.title)}</div>
            <div class="doc-desc">${esc(p.desc)}</div>
          </div>
          <div class="doc-actions">
            ${p.url
              ? `<a href="${p.url}" download="${esc(p.title)}.pdf" class="btn-download">â¬‡ ØªØ­Ù…ÙŠÙ„</a>`
              : `<span class="btn-coming">Ù‚Ø±ÙŠØ¨Ù‹Ø§â€¦</span>`}
            <button class="doc-del" onclick="delPDF(${i})" title="Ø­Ø°Ù">ğŸ—‘</button>
          </div>
        </div>`).join('')
    : `<div class="empty"><span class="empty-icon">ğŸ“„</span><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª PDF Ø¨Ø¹Ø¯.</p></div>`;

  document.getElementById('page').innerHTML = `
    <div class="sec-header">
      <div class="sec-icon">ğŸ“„</div>
      <h2>ØªØ­Ù…ÙŠÙ„ PDF</h2>
      <span class="sec-count">${pdfs.length}</span>
    </div>
    ${adminBar}
    <div class="doc-list">${items}</div>`;
}

function submitPDF() {
  const file  = document.getElementById('f-pfile').files[0];
  const title = document.getElementById('f-ptitle').value.trim();
  const desc  = document.getElementById('f-pdesc').value.trim();
  if(!title) { toast('âŒ Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù', 'err'); return; }
  let url = null;
  if(file) {
    if(file.type !== 'application/pdf' && !file.name.endsWith('.pdf'))
      { toast('âŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ù„Ù Ù…Ù† Ù†ÙˆØ¹ PDF', 'err'); return; }
    if(file.size > 20*1024*1024)
      { toast('âŒ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØªØ¬Ø§ÙˆØ² 20 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª', 'err'); return; }
    url = URL.createObjectURL(file);
  }
  pdfs.unshift({ title, desc:desc||'Ù…Ù„Ù Ø¯Ø±Ø³', url });
  ['f-pfile','f-ptitle','f-pdesc'].forEach(id => { document.getElementById(id).value=''; });
  closeM('m-pdf');
  toast(`âœ… ØªÙ… Ø±ÙØ¹ "${title}" Ø¨Ù†Ø¬Ø§Ø­!`);
  renderPDFs();
}

function delPDF(i) {
  if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„ÙØŸ')) return;
  pdfs.splice(i,1);
  toast('ØªÙ… Ø§Ù„Ø­Ø°Ù', 'inf');
  renderPDFs();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EXERCISES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderExercises() {
  const adminBar = isAdmin ? `
    <div class="admin-bar">
      <span class="admin-bar-label">ğŸ›¡ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</span>
      <button class="btn btn-primary btn-sm" onclick="openM('m-ex')">â• Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø³Ù„Ø©</button>
      <button class="btn btn-danger  btn-sm" onclick="doLogout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>` : '';

  const items = exercises.length
    ? exercises.map((ex,i) => `
        <div class="doc-item">
          <div class="doc-icon ex">ğŸ“</div>
          <div class="doc-body">
            <div class="doc-title">${esc(ex.title)}</div>
            <div class="doc-desc">${esc(ex.desc)}</div>
          </div>
          <div class="doc-actions">
            ${ex.url
              ? `<a href="${ex.url}" download="${esc(ex.title)}.pdf" class="btn-download">â¬‡ ØªØ­Ù…ÙŠÙ„</a>`
              : `<span class="btn-coming">Ù‚Ø±ÙŠØ¨Ù‹Ø§â€¦</span>`}
            <button class="doc-del" onclick="delExercise(${i})" title="Ø­Ø°Ù">ğŸ—‘</button>
          </div>
        </div>`).join('')
    : `<div class="empty"><span class="empty-icon">ğŸ“</span><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ù„Ø§Ø³Ù„ Ø¨Ø¹Ø¯.</p></div>`;

  document.getElementById('page').innerHTML = `
    <div class="sec-header">
      <div class="sec-icon">ğŸ“</div>
      <h2>Ø³Ù„Ø§Ø³Ù„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</h2>
      <span class="sec-count">${exercises.length}</span>
    </div>
    ${adminBar}
    <div class="doc-list">${items}</div>`;
}

function submitExercise() {
  const file  = document.getElementById('f-exfile').files[0];
  const title = document.getElementById('f-extitle').value.trim();
  const desc  = document.getElementById('f-exdesc').value.trim();
  if(!title) { toast('âŒ Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³Ù„Ø³Ù„Ø©', 'err'); return; }
  const url = file ? URL.createObjectURL(file) : null;
  exercises.unshift({ title, desc:desc||'Ø³Ù„Ø³Ù„Ø© ØªÙ…Ø§Ø±ÙŠÙ†', url });
  ['f-exfile','f-extitle','f-exdesc'].forEach(id => { document.getElementById(id).value=''; });
  closeM('m-ex');
  toast('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­!');
  renderExercises();
}

function delExercise(i) {
  if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù„Ø³Ù„Ø©ØŸ')) return;
  exercises.splice(i,1);
  toast('ØªÙ… Ø§Ù„Ø­Ø°Ù', 'inf');
  renderExercises();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TESTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderTests() {
  const adminBar = isAdmin ? `
    <div class="admin-bar">
      <span class="admin-bar-label">ğŸ›¡ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</span>
      <button class="btn btn-primary btn-sm" onclick="openM('m-test')">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù…ØªØ­Ø§Ù†</button>
      <button class="btn btn-danger  btn-sm" onclick="doLogout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>` : '';

  const items = tests.length
    ? tests.map((t,i) => `
        <div class="doc-item">
          <div class="doc-icon test">ğŸ“‹</div>
          <div class="doc-body">
            <div class="doc-title">${esc(t.title)}</div>
            <div class="doc-desc">${esc(t.desc)}</div>
          </div>
          <div class="doc-actions">
            ${t.url
              ? `<a href="${t.url}" download="${esc(t.title)}.pdf" class="btn-download">â¬‡ ØªØ­Ù…ÙŠÙ„</a>`
              : `<span class="btn-coming">Ù‚Ø±ÙŠØ¨Ù‹Ø§â€¦</span>`}
            <button class="doc-del" onclick="delTest(${i})" title="Ø­Ø°Ù">ğŸ—‘</button>
          </div>
        </div>`).join('')
    : `<div class="empty"><span class="empty-icon">ğŸ“‹</span><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø¨Ø¹Ø¯.</p></div>`;

  document.getElementById('page').innerHTML = `
    <div class="sec-header">
      <div class="sec-icon">ğŸ“‹</div>
      <h2>Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©</h2>
      <span class="sec-count">${tests.length}</span>
    </div>
    ${adminBar}
    <div class="doc-list">${items}</div>`;
}

function submitTest() {
  const file  = document.getElementById('f-testfile').files[0];
  const title = document.getElementById('f-testtitle').value.trim();
  const desc  = document.getElementById('f-testdesc').value.trim();
  if(!title) { toast('âŒ Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†', 'err'); return; }
  const url = file ? URL.createObjectURL(file) : null;
  tests.unshift({ title, desc:desc||'Ø§Ù…ØªØ­Ø§Ù† ØªØ¬Ø±ÙŠØ¨ÙŠ', url });
  ['f-testfile','f-testtitle','f-testdesc'].forEach(id => { document.getElementById(id).value=''; });
  closeM('m-test');
  toast('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­!');
  renderTests();
}

function delTest(i) {
  if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†ØŸ')) return;
  tests.splice(i,1);
  toast('ØªÙ… Ø§Ù„Ø­Ø°Ù', 'inf');
  renderTests();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MENU â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function toggleMenu() {
  menuOpen = !menuOpen;
  document.getElementById('nav-links').classList.toggle('open', menuOpen);
}
function closeMenu() {
  menuOpen = false;
  document.getElementById('nav-links').classList.remove('open');
}
document.addEventListener('click', e => {
  if(!e.target.closest('#nav-links') && !e.target.closest('#hamburger')) closeMenu();
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CHAT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function toggleChat() {
  chatOpen = !chatOpen;
  const box = document.getElementById('chat-box');
  const fab = document.getElementById('chat-fab');
  box.classList.toggle('open', chatOpen);
  fab.classList.toggle('open', chatOpen);
  if(chatOpen) renderFriends();
}

function renderFriends() {
  document.getElementById('friends-list').innerHTML =
    friends.map(f => `
      <div class="friend ${selFriend?.id===f.id?'active':''}" onclick="selF(${f.id})">
        <div class="f-avatar">${f.av}</div>
        <div>
          <div class="f-name">${f.name}</div>
          <div class="f-status">Ù…ØªØµÙ„</div>
        </div>
      </div>`).join('');
}

function filterFriends(q) {
  document.querySelectorAll('.friend').forEach((el,i) => {
    el.style.display = friends[i].name.includes(q) ? '' : 'none';
  });
}

function selF(id) {
  selFriend = friends.find(f=>f.id===id);
  renderFriends();
  renderChatMain();
}

function renderChatMain() {
  document.getElementById('chat-main').innerHTML = `
    <div class="chat-header">
      <div class="ch-info">
        <div class="f-avatar" style="width:32px;height:32px;font-size:13px">${selFriend.av}</div>
        <div>
          <div class="ch-name">${selFriend.name}</div>
          <div class="ch-sub">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</div>
        </div>
      </div>
      <button class="ch-close" onclick="clearSel()">Ã—</button>
    </div>
    <div id="chat-msgs"></div>
    <div class="chat-input-area">
      <div class="input-row">
        <div class="media-btns">
          <button class="media-btn" onclick="document.getElementById('img-pick').click()" title="Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø©">ğŸ–¼ï¸</button>
          <button class="media-btn" onclick="document.getElementById('aud-pick').click()" title="Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØª">ğŸµ</button>
        </div>
        <textarea id="msg-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒâ€¦" rows="1"></textarea>
        <button id="send-btn" onclick="sendMsg()">â¤</button>
      </div>
    </div>`;

  document.getElementById('msg-input').addEventListener('keydown', e => {
    if(e.key==='Enter' && !e.shiftKey) { e.preventDefault(); sendMsg(); }
  });
  renderMsgs();
}

function clearSel() {
  selFriend = null;
  renderFriends();
  document.getElementById('chat-main').innerHTML = `
    <div class="chat-no-sel">
      <span class="big">ğŸ’¬</span>
      <p>Ø§Ø®ØªØ± ØµØ¯ÙŠÙ‚Ù‹Ø§ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</p>
    </div>`;
}

function renderMsgs() {
  const msgs = convos[selFriend.id] || [];
  const c = document.getElementById('chat-msgs');
  if(!c) return;
  c.innerHTML = msgs.length
    ? msgs.map(m => buildBubble(m)).join('')
    : `<div style="text-align:center;color:var(--text3);padding:30px;font-size:13px">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ğŸ‘‹</div>`;
  c.scrollTop = c.scrollHeight;
}

function buildBubble(m) {
  const cls = m.from==='me' ? 'me' : 'you';
  let inner = '';
  if(m.type==='text')  inner = `<div>${esc(m.text)}</div>`;
  if(m.type==='image') inner = `<img src="${m.url}" class="msg-img" onclick="window.open('${m.url}','_blank')" alt="ØµÙˆØ±Ø©">`;
  if(m.type==='audio') inner = `
    <div class="audio-pill">
      <button class="audio-btn" onclick="(new Audio('${m.url}')).play()">â–¶</button>
      <span class="audio-label">Ø±Ø³Ø§Ù„Ø© ØµÙˆØªÙŠØ©</span>
    </div>`;
  return `<div class="msg-row ${cls}">
    <div class="bubble">${inner}<div class="msg-time">${m.time}</div></div>
  </div>`;
}

function sendMsg() {
  const input = document.getElementById('msg-input');
  const text  = input?.value.trim();
  if(!text || !selFriend) return;
  push({ from:'me', type:'text', text, time:now() });
  input.value = '';
  // Simulate reply
  setTimeout(() => {
    const replies = ['Ø­Ø³Ù†Ù‹Ø§ ğŸ‘','Ø´ÙƒØ±Ù‹Ø§ Ø¹Ù„Ù‰ ØªÙˆØ§ØµÙ„Ùƒ!','Ø³Ø¤Ø§Ù„ Ù…Ù…ØªØ§Ø²! ğŸŒŸ','ØªÙ…Ø§Ù…ØŒ Ø³Ø£Ù†Ø¸Ø± ÙÙŠ Ø§Ù„Ø£Ù…Ø±','Ù„Ø§ Ø¨Ø£Ø³ ğŸ˜Š'];
    push({ from:'friend', type:'text', text:replies[Math.random()*replies.length|0], time:now() });
  }, 900 + Math.random()*600);
}

function push(msg) {
  convos[selFriend.id].push(msg);
  renderMsgs();
}

/* File picks */
document.getElementById('img-pick').addEventListener('change', function() {
  const file = this.files[0];
  if(!file || !selFriend) { this.value=''; return; }
  if(!file.type.startsWith('image/')) { toast('âŒ Ø§Ø®ØªØ± Ù…Ù„Ù ØµÙˆØ±Ø© ØµØ­ÙŠØ­', 'err'); this.value=''; return; }
  if(file.size > 5*1024*1024) { toast('âŒ Ø§Ù„ØµÙˆØ±Ø© Ø£ÙƒØ¨Ø± Ù…Ù† 5 Ù…ÙŠØ¬Ø§', 'err'); this.value=''; return; }
  const r = new FileReader();
  r.onload = e => { push({ from:'me', type:'image', url:e.target.result, time:now() }); };
  r.readAsDataURL(file);
  this.value = '';
});

document.getElementById('aud-pick').addEventListener('change', function() {
  const file = this.files[0];
  if(!file || !selFriend) { this.value=''; return; }
  if(!file.type.startsWith('audio/')) { toast('âŒ Ø§Ø®ØªØ± Ù…Ù„Ù ØµÙˆØª ØµØ­ÙŠØ­', 'err'); this.value=''; return; }
  if(file.size > 10*1024*1024) { toast('âŒ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ Ø£ÙƒØ¨Ø± Ù…Ù† 10 Ù…ÙŠØ¬Ø§', 'err'); this.value=''; return; }
  const r = new FileReader();
  r.onload = e => { push({ from:'me', type:'audio', url:e.target.result, time:now() }); };
  r.readAsDataURL(file);
  this.value = '';
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function now() {
  return new Date().toLocaleTimeString('ar-EG', { hour:'2-digit', minute:'2-digit' });
}

function esc(s) {
  if(!s) return '';
  return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
nav('home');
</script>
</body>
</html>
